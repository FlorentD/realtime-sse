{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from \"react\";\nimport Layout from \"../components/layout\";\nimport { Heading } from \"rebass\";\nconst options = {\n  weekday: \"long\",\n  year: \"numeric\",\n  month: \"long\",\n  day: \"numeric\",\n  hour: \"2-digit\",\n  minute: \"2-digit\",\n  second: \"2-digit\"\n};\n\nconst formatAmount = amount => `${amount}`.split(/(?=(?:\\d{3})+(?:\\.|$))/g).join(\" \");\n\nconst formatDate = date => `${new Date(date).toLocaleDateString(\"fr-FR\", options)}`;\n\nfunction HomePage() {\n  const {\n    0: kissKissAmount,\n    1: setKissKissAmount\n  } = useState(0);\n  const {\n    0: ululeAmount,\n    1: setUluleAmount\n  } = useState(0);\n  const {\n    0: kissKissUpdate,\n    1: setKissKissUpdate\n  } = useState(\"\");\n  const {\n    0: ululeUpdate,\n    1: setUluleUpdate\n  } = useState(\"\");\n  useEffect(() => {\n    fetch(\"/api\").then(response => response.json()).then(({\n      kisskissbankbank,\n      ulule\n    }) => {\n      setKissKissAmount(formatAmount(kisskissbankbank));\n      setUluleAmount(formatAmount(ulule));\n    });\n  }, []);\n  useEffect(() => {\n    const evtSource = new EventSource(\"/sse\");\n\n    evtSource.onopen = e => console.log(\"open\", e);\n\n    evtSource.onerror = e => console.error(\"error\", e);\n\n    evtSource.addEventListener(\"kisskissbankbank\", e => {\n      console.log(e.data);\n      const {\n        amount,\n        update\n      } = JSON.parse(e.data);\n      setKissKissAmount(formatAmount(amount));\n      setKissKissUpdate(formatDate(update));\n    });\n    evtSource.addEventListener(\"ulule\", e => {\n      const {\n        amount,\n        update\n      } = JSON.parse(e.data);\n      setUluleAmount(formatAmount(amount));\n      setUluleUpdate(formatDate(update));\n    });\n  }, []);\n  return /*#__PURE__*/_jsxs(Layout, {\n    children: [/*#__PURE__*/_jsx(Heading, {\n      fontSize: [5],\n      children: \"Projets populaires\"\n    }), /*#__PURE__*/_jsx(Heading, {\n      color: \"secondary\",\n      children: \"Argent collect\\xE9 en temps r\\xE9el\"\n    }), /*#__PURE__*/_jsxs(\"ul\", {\n      children: [/*#__PURE__*/_jsxs(\"li\", {\n        children: [\"KissKissBankBank : \", /*#__PURE__*/_jsx(\"span\", {\n          children: kissKissAmount\n        }), \"\\u20AC -\", \" \", /*#__PURE__*/_jsx(\"span\", {\n          children: kissKissUpdate\n        })]\n      }), /*#__PURE__*/_jsxs(\"li\", {\n        children: [\"Ulule : \", /*#__PURE__*/_jsx(\"span\", {\n          children: ululeAmount\n        }), \"\\u20AC - \", /*#__PURE__*/_jsx(\"span\", {\n          children: ululeUpdate\n        })]\n      })]\n    })]\n  });\n}\n\nexport default HomePage;","map":null,"metadata":{},"sourceType":"module"}