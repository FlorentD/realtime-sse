{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from \"react\";\nimport Layout from \"../components/layout\";\nimport { Heading } from \"rebass\";\nvar options = {\n  weekday: \"long\",\n  year: \"numeric\",\n  month: \"long\",\n  day: \"numeric\",\n  hour: \"2-digit\",\n  minute: \"2-digit\",\n  second: \"2-digit\"\n};\n\nvar formatAmount = function formatAmount(amount) {\n  return \"\".concat(amount).split(/(?=(?:\\d{3})+(?:\\.|$))/g).join(\" \");\n};\n\nvar formatDate = function formatDate(date) {\n  return \"\".concat(new Date(date).toLocaleDateString(\"fr-FR\", options));\n};\n\nfunction HomePage() {\n  var _useState = useState(0),\n      kissKissAmount = _useState[0],\n      setKissKissAmount = _useState[1];\n\n  var _useState2 = useState(0),\n      ululeAmount = _useState2[0],\n      setUluleAmount = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      kissKissUpdate = _useState3[0],\n      setKissKissUpdate = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      ululeUpdate = _useState4[0],\n      setUluleUpdate = _useState4[1];\n\n  useEffect(function () {\n    fetch(\"/api\").then(function (response) {\n      return response.json();\n    }).then(function (_ref) {\n      var kisskissbankbank = _ref.kisskissbankbank,\n          ulule = _ref.ulule;\n      setKissKissAmount(formatAmount(kisskissbankbank));\n      setUluleAmount(formatAmount(ulule));\n    });\n  }, []);\n  useEffect(function () {\n    var evtSource = new EventSource(\"/sse\");\n\n    evtSource.onopen = function (e) {\n      return console.log(\"open\", e);\n    };\n\n    evtSource.onerror = function (e) {\n      return console.error(\"error\", e);\n    };\n\n    evtSource.addEventListener(\"kisskissbankbank\", function (e) {\n      console.log(e.data);\n\n      var _JSON$parse = JSON.parse(e.data),\n          amount = _JSON$parse.amount,\n          update = _JSON$parse.update;\n\n      setKissKissAmount(formatAmount(amount));\n      setKissKissUpdate(formatDate(update));\n    });\n    evtSource.addEventListener(\"ulule\", function (e) {\n      var _JSON$parse2 = JSON.parse(e.data),\n          amount = _JSON$parse2.amount,\n          update = _JSON$parse2.update;\n\n      setUluleAmount(formatAmount(amount));\n      setUluleUpdate(formatDate(update));\n    });\n  }, []);\n  return /*#__PURE__*/_jsxs(Layout, {\n    children: [/*#__PURE__*/_jsx(Heading, {\n      fontSize: [5],\n      children: \"Projets populaires\"\n    }), /*#__PURE__*/_jsx(Heading, {\n      color: \"secondary\",\n      children: \"Argent collect\\xE9 en temps r\\xE9el\"\n    }), /*#__PURE__*/_jsxs(\"ul\", {\n      children: [/*#__PURE__*/_jsxs(\"li\", {\n        children: [\"KissKissBankBank : \", /*#__PURE__*/_jsx(\"span\", {\n          children: kissKissAmount\n        }), \"\\u20AC -\", \" \", /*#__PURE__*/_jsx(\"span\", {\n          children: kissKissUpdate\n        })]\n      }), /*#__PURE__*/_jsxs(\"li\", {\n        children: [\"Ulule : \", /*#__PURE__*/_jsx(\"span\", {\n          children: ululeAmount\n        }), \"\\u20AC - \", /*#__PURE__*/_jsx(\"span\", {\n          children: ululeUpdate\n        })]\n      })]\n    })]\n  });\n}\n\nexport default HomePage;","map":null,"metadata":{},"sourceType":"module"}